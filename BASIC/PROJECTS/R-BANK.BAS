10 ' ***************************************
20 ' *****                        *****
30 ' *****         *****
40 ' *****                             *****
50 ' *****            *****
60 ' ***** 1986 -        9- -  *****
70 ' *****              -  *****
80 ' ***************************************
90 '
100 ' *****  *****
110 KEY OFF:DEF SEG=0:DEF SEG=PEEK(&H42)+256*PEEK(&H43)
120 IF CHR$(PEEK(0))+CHR$(PEEK(1))+CHR$(PEEK(2))="HEB" THEN 140
130 CLS:PRINT "   'HEBREW'   ":END
140 ' *****   *****
150 OPEN "R",#1,"BANKNUM.DAT",128
160 FIELD 1,8 AS NLINES$,30 AS NAM$,24 AS CLIENTADD$,15 AS NACCOUNT$,20 AS TYPEACC$,3 AS TANUM$,20 AS BANKNAM$,5 AS BANKNUM$,3 AS BANKKOD$
170 GET #1,1:CLIENT=VAL(NLINES$)
180 DIM BNK$(17,8)
190 ' *****   *****
200 DA$=DATE$:GOTO 520
220 LOCATE 8,27:PRINT "ͻ"
230 LOCATE 9,27:PRINT " __/__/____ :  "
240 LOCATE 10,27:PRINT "ͼ"
250 DD$=MID$(DATE$,4,2)
260 MM$=MID$(DATE$,1,2)
270 YY$=MID$(DATE$,7,4)
280 LOCATE 9,29:PRINT DD$;"/";MM$;"/";YY$:DA$=DD$+MM$+YY$
290 LOCATE 22,2:PRINT SPACE$(77):LOCATE 22,22:PRINT "{RETURN}     "
300 X=29:A$=MID$(DA$,1,1):W=1
310 E$="":LOCATE 9,X:PRINT "":LOCATE 9,X:PRINT A$:E$=INKEY$:IF E$="" THEN 310
320 IF E$=CHR$(13) THEN 450
330 IF ASC(E$)<48 OR ASC(E$)>57 THEN BEEP:GOTO 310
340 DD$=MID$(DA$,1,2)
350 MM$=MID$(DA$,3,2)
360 YY$=MID$(DA$,5,4)
380 MID$(DA$,W,1)=E$
390 W=W+1:LOCATE 9,X:PRINT E$
400 A$=MID$(DA$,W,1)
410 X=X+1:IF X=39 THEN X=38:BEEP:A$=MID$(DA$,W-1,1):W=W-1:GOTO 310
420 IF W=3 THEN X=32
430 IF W=5 THEN X=35
440 GOTO 310
450 LOCATE 13,28:PRINT " : ( / )   "
460 LOCATE 22,2:PRINT SPACE$(77):LOCATE 22,28:PRINT "- ()  - () "
470 E$="":E$=INKEY$:IF E$="" THEN 470
480 LOCATE 13,26:IF E$="F" OR E$="f" OR E$="" THEN LOCATE 13,26:PRINT "                             ":GOTO 300
490 IF E$="K" OR E$="k" OR E$="" THEN PRINT "":GOTO 510
500 BEEP:GOTO 470
510 FOR I=1 TO 250:NEXT I
520 DD$=MID$(DA$,1,2)
530 MM$=MID$(DA$,3,2)
540 YY$=MID$(DA$,7,2)
550 ' *****   *****
560 POKE 8,0:LOCATE 3,3:PRINT DD$;"/";MM$;"/";YY$
570 CLS:LOCATE 5,33:COLOR 1,0:PRINT ":   :":COLOR 3,0
580 LOCATE 7,15:PRINT "      .( )    .01"
590 LOCATE 8,15:PRINT "                  . ,  .02"
600 LOCATE 9,15:PRINT "                        .  .03"
610 LOCATE 11,15:PRINT "                                . .09"
620 LOCATE 19,31:PRINT "_ :   "
630 A$=" -     ,9/ ,       ( ) "
640 L=LEN(A$):Y=22:X=3:F=75:W=L-1:N=1
650 S$=MID$(A$,W,F):LOCATE Y,X:PRINT S$:W=W-1:IF W=0 THEN Q=1:GOTO 660 ELSE FOR I=1 TO N:E$=INKEY$:IF E$="" THEN NEXT I:GOTO 650 ELSE 670
660 D$=MID$(A$,LEN(A$)-Q+1,Q):S$=D$+MID$(A$,1,F-LEN(D$)):LOCATE Y,X:PRINT S$:IF F-LEN(D$)=1 THEN W=L-Q+1:GOTO 650 ELSE Q=Q+1:FOR I=1 TO N:E$=INKEY$:IF E$="" THEN NEXT I:GOTO 660
670 IF E$="9" THEN LOCATE 19,31:PRINT "9":RSET NLINES$=STR$(CLIENT):PUT #1,1:CLOSE:END
680 IF E$<"1" OR E$>"3" THEN BEEP:GOTO 650
690 LOCATE 19,31:PRINT E$:ON VAL(E$) GOTO 3440,700,3190
700 ' *****   *****
710 LOCATE 3,3:PRINT DD$;"/";MM$;"/";YY$
720 LOCATE 3,33:COLOR 1,0:PRINT ":   :":COLOR 3,0
730 LOCATE 5,12:PRINT "ͻ"
740 LOCATE 6,12:PRINT " 000000 :                                       "
750 LOCATE 6,34:COLOR 1,0:PRINT ":   :":COLOR 3,0
760 LOCATE 7,12:PRINT "                                                        "
770 LOCATE 8,12:PRINT "                           000000000000000 :   "
780 LOCATE 9,12:PRINT "            ______________________________ :       "
790 LOCATE 10,12:PRINT "                  ________________________ :   "
800 LOCATE 11,12:PRINT " 000 :        ____________________ :    "
810 LOCATE 12,12:PRINT "                                                        "
820 LOCATE 13,12:PRINT "                                                        "
830 LOCATE 13,35:COLOR 1,0:PRINT ":   :":COLOR 3,0
840 LOCATE 14,12:PRINT "                                                        "
850 LOCATE 15,12:PRINT " 000 :          ____________________ :       "
860 LOCATE 16,12:PRINT "                                     00000 :    "
870 LOCATE 17,12:PRINT "                                                        "
880 LOCATE 18,12:PRINT "ͼ"
890 LOCATE 6,14:PRINT "000000":LOCATE 6,15+(6-(LEN(STR$(CLIENT+1)))):COLOR 11,0:PRINT RIGHT$(STR$(CLIENT+1),(LEN(STR$(CLIENT+1))-1)):COLOR 3,0
900 IF IPT=0 THEN IPT=1:DIM IPT$(8),IPT(8),IPL(8)
910 FOR I=1 TO 8:IPT$(I)="":IPT(I)=0:IPL(I)=0:NEXT I
920 ' *****    *****
930 ABC=0:LOCATE 22,18:PRINT "  + - , [<-] , [Esc]":LOCATE 20,2:PRINT SPACE$(77):GOSUB 2640:LOCATE 8,68:PRINT "*":ENTRY=CLIENT+1:IT=0:LOCATE 20,16:COLOR 0,1:PRINT "  ( )      "
940 COLOR 3,0:IF IPT(1)=0 THEN X=55:IPT$(1)="":IPT(1)=1 ELSE X=IPL(1)
950 E$=INKEY$:IF E$="" THEN 950
960 IF E$="-" THEN ABC=1:LST=1:TYP=1:GOSUB 2720:GOTO 950
970 IF E$="+" THEN ABC=1:LST=0:TYP=0:GOSUB 2720:GOTO 950
980 IF E$=CHR$(27) THEN 550
990 IF E$=CHR$(13) THEN IF VAL(IPT$(1))=0 THEN BEEP:LOCATE 19,22:PRINT "! ()      ":FOR I=1 TO 250:NEXT I:LOCATE 19,22:PRINT "                                    ":GOTO 950 ELSE 1050
1000 IF E$=CHR$(8) AND LEN(IPT$(1))=0 THEN BEEP:LOCATE 19,28:PRINT "    ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 950
1010 IF E$=CHR$(8) THEN IPT$(1)=LEFT$(IPT$(1),((LEN(IPT$(1)))-1)):LOCATE 8,X:PRINT "0":X=X+1:LOCATE 8,X:COLOR 11,0:PRINT IPT$(1):COLOR 3,0:GOTO 950
1020 IF ASC(E$)<48 OR ASC(E$)>57 THEN BEEP:LOCATE 19,28:PRINT "   ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 950
1030 IF LEN(IPT$(1))=15 THEN BEEP:LOCATE 19,22:PRINT " 15 -    ":FOR I=1 TO 250:NEXT I:LOCATE 19,22:PRINT "                                    ":GOTO 950
1040 X=X-1:IPT$(1)=IPT$(1)+E$:COLOR 11,0:LOCATE 8,X:PRINT IPT$(1):COLOR 3,0:GOTO 950
1050 ' *****      *****
1060 LOCATE 8,X:COLOR 11,0:PRINT IPT$(1):COLOR 3,0:B$=IPT$(1):C$="":FOR D=LEN(B$) TO 14:C$=C$+" ":NEXT D:B$=C$+B$:FOR J=2 TO CLIENT+1:GET #1,J
1070 IF B$=NACCOUNT$ THEN LOCATE 8,68:PRINT " ":A$=B$:GOSUB 2660:LOCATE 8,68:PRINT "*":LOCATE 6,14:PRINT "000000":LOCATE 6,15+(6-LEN(STR$(J))):COLOR 11,0:PRINT RIGHT$(STR$(J),LEN(STR$(J))-1):COLOR 3,0:ENTRY=J:ABC=1:GOTO 950
1080 NEXT J:GOSUB 2880:LOCATE 6,14:PRINT "000000":LOCATE 6,15+(6-LEN(STR$(CLIENT+1))):COLOR 11,0:PRINT RIGHT$(STR$(CLIENT+1),LEN(STR$(CLIENT+1))-1):COLOR 3,0
1090 LOCATE 8,55-LEN(IPT$(1)):COLOR 11,0:PRINT IPT$(1):COLOR 3,0:IPL(1)=X:IF ABC=1 THEN ABC=0:FOR I=2 TO 8:IPT$(I)="":IPT(I)=0:IPL(I)=0:NEXT I
1100 ' *****     *****
1110 LOCATE 22,2:PRINT SPACE$(77):LOCATE 22,26:PRINT " [<-] ,  [Esc]":LOCATE 20,2:PRINT SPACE$(77):GOSUB 2640:LOCATE 9,68:PRINT "*":LOCATE 20,7:COLOR 0,1:PRINT "  [Caps Lock]    ( + )   "
1120 COLOR 3,0:IF IPT(2)=0 THEN X=26:IPT$(2)="":IPT(2)=1 ELSE X=IPL(2)
1130 POKE 8,1:E$=INKEY$:IF E$="" THEN 1130 ELSE POKE 8,0
1140 IF E$=CHR$(27) THEN IPL(2)=X:GOTO 920
1150 IF E$=CHR$(13) THEN IF LEN(IPT$(2))=0 THEN BEEP:LOCATE 19,29:PRINT "    ":FOR I=1 TO 250:NEXT I:LOCATE 19,29:PRINT "                      ":GOTO 1130 ELSE 1200
1160 IF E$=CHR$(8) AND LEN(IPT$(2))=0 THEN BEEP:LOCATE 19,28:PRINT "    ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 1130
1170 IF E$=CHR$(8) THEN POKE 8,1:IPT$(2)=LEFT$(IPT$(2),(LEN(IPT$(2))-1)):LOCATE 9,X:PRINT "_":X=X-1:LOCATE 9,27:COLOR 11,0:PRINT IPT$(2):COLOR 3,0:POKE 8,0:GOTO 1130
1180 IF LEN(IPT$(2))=30 THEN BEEP:LOCATE 19,23:PRINT " 30 -    ":FOR I=1 TO 250:NEXT I:LOCATE 19,23:PRINT "                                 ":GOTO 1130
1190 X=X+1:IPT$(2)=IPT$(2)+E$:POKE 8,1:LOCATE 9,X:COLOR 11,0:PRINT E$:COLOR 3,0:POKE 8,0:GOTO 1130
1200 IPL(2)=X
1210 ' *****   *****
1220 LOCATE 20,2:PRINT SPACE$(77):GOSUB 2640:LOCATE 10,68:PRINT "*":LOCATE 20,12:COLOR 0,1:PRINT "  [Caps Lock]    ,  "
1230 COLOR 3,0:IF IPT(3)=0 THEN X=26:IPT$(3)="":IPT(3)=1 ELSE X=IPL(3)
1240 POKE 8,1:E$=INKEY$:IF E$="" THEN 1240 ELSE POKE 8,0
1250 IF E$=CHR$(27) THEN IPL(3)=X:GOTO 1100
1260 IF E$=CHR$(13) THEN 1310
1270 IF E$=CHR$(8) AND LEN(IPT$(3))=0 THEN BEEP:LOCATE 19,28:PRINT "    ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 1240
1280 IF E$=CHR$(8) THEN POKE 8,1:IPT$(3)=LEFT$(IPT$(3),(LEN(IPT$(3))-1)):LOCATE 10,X:PRINT "_":X=X-1:LOCATE 10,27:COLOR 11,0:PRINT IPT$(3):COLOR 3,0:POKE 8,0:GOTO 1240
1290 IF LEN(IPT$(3))=24 THEN BEEP:LOCATE 19,23:PRINT " 24 -    ":FOR I=1 TO 250:NEXT I:LOCATE 19,23:PRINT "                                 ":GOTO 1240
1300 X=X+1:IPT$(3)=IPT$(3)+E$:POKE 8,1:LOCATE 10,X:COLOR 11,0:PRINT E$:COLOR 3,0:POKE 8,0:GOTO 1240
1310 IPL(3)=X
1320 ' *****   *****
1330 TYPE=0:RESTORE 1680:GOSUB 2640:LOCATE 11,68
1340 PRINT "*":LOCATE 20,2:PRINT SPACE$(77)
1350 DAFDAF=1:LOCATE 20,3:COLOR 0,1:PRINT "  + ,  [Caps Lock]    ,  ":COLOR 3,0
1360 IF IPT(4)=0 THEN X=26:IPT$(4)="":IPT(4)=1 ELSE X=IPL(4)
1370 POKE 8,1:E$=INKEY$:IF E$="" THEN 1370 ELSE POKE 8,0
1380 IF E$=CHR$(27) THEN IPL(4)=X:KEY(3) OFF:GOTO 1210
1390 IF E$="+" THEN GOSUB 1600:GOTO 1370
1400 IF E$=CHR$(13) THEN IF LEN(IPT$(4))=0 THEN BEEP:LOCATE 19,25:PRINT "     ":FOR I=1 TO 250:NEXT I:LOCATE 19,2:PRINT SPACE$(77):GOTO 1370 ELSE GOTO 1450
1410 IF E$=CHR$(8) AND LEN(IPT$(4))=0 THEN BEEP:LOCATE 19,28:PRINT "    ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 1370
1420 IF E$=CHR$(8) THEN POKE 8,1:IPT$(4)=LEFT$(IPT$(4),(LEN(IPT$(4))-1)):LOCATE 11,X:PRINT "_":X=X-1:LOCATE 11,27:COLOR 11,0:PRINT IPT$(4):COLOR 3,0:POKE 8,0:GOTO 1370
1430 IF LEN(IPT$(4))=20 THEN BEEP:LOCATE 19,20:PRINT " 20 -     ":FOR I=1 TO 250:NEXT I:LOCATE 19,20:PRINT "                                        ":GOTO 1370
1440 X=X+1:IPT$(4)=IPT$(4)+E$:POKE 8,1:LOCATE 11,X:COLOR 11,0:PRINT E$:COLOR 3,0:POKE 8,0:GOTO 1370
1450 IPL(4)=X
1460 ' *****    *****
1470 LOCATE 20,2:PRINT SPACE$(77):GOSUB 2640:LOCATE 11,29:PRINT "*"
1480 DAFDAF=2:LOCATE 20,22:COLOR 0,1:PRINT "  + ,  ":COLOR 3,0
1490 IF IPT(8)=0 THEN X=17:IPT$(8)="":IPT(8)=1 ELSE X=IPL(8)
1500 E$=INKEY$:IF E$="" THEN 1500
1510 IF E$=CHR$(27) THEN IPL(8)=X:GOTO 1320
1520 IF E$="+" THEN GOSUB 1600:GOTO 1500
1530 IF E$=CHR$(13) THEN IF VAL(IPT$(8))=0 THEN BEEP:LOCATE 19,22:PRINT "! ()      ":FOR I=1 TO 1000:NEXT I:LOCATE 19,22:PRINT "                                   ":GOTO 1500 ELSE 1590
1540 IF E$=CHR$(8) AND LEN(IPT$(8))=0 THEN BEEP:LOCATE 19,28:PRINT "    ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 1500
1550 IF E$=CHR$(8) THEN IPT$(8)=LEFT$(IPT$(8),((LEN(IPT$(8)))-1)):LOCATE 11,X:PRINT "0":X=X+1:LOCATE 11,X:COLOR 11,0:PRINT IPT$(8):COLOR 3,0:GOTO 1500
1560 IF ASC(E$)<48 OR ASC(E$)>57 THEN BEEP:LOCATE 19,28:PRINT "   ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 1500
1570 IF LEN(IPT$(8))=3 THEN BEEP:LOCATE 19,22:PRINT " 3 -    ":FOR I=1 TO 250:NEXT I:LOCATE 19,22:PRINT "                                   ":GOTO 1500
1580 X=X-1:IPT$(8)=IPT$(8)+E$:COLOR 11,0:LOCATE 11,X:PRINT IPT$(8):COLOR 3,0:GOTO 1500
1590 LOCATE 11,17-LEN(IPT$(8)):COLOR 11,0:PRINT IPT$(8):COLOR 3,0:IPL(8)=X:KEY(3) OFF:GOTO 1750
1600 ' *****    *****
1610 POKE 8,1:LOCATE 11,27:PRINT "____________________":POKE 8,0:LOCATE 11,14:PRINT "000":READ A$,TA$:LOCATE 11,55-(LEN(A$)):COLOR 11,0:PRINT A$:LOCATE 11,17-LEN(TA$):PRINT TA$:COLOR 3,0:TYPE=TYPE+1:IF TYPE=7 THEN TYPE=0:RESTORE 1680
1620 B$="":FOR I=1 TO LEN(A$)
1630 X$=MID$(A$,LEN(A$)-I+1,1)
1640 B$=B$+X$
1650 NEXT I
1660 IF DAFDAF=1 THEN X=26+LEN(B$):IPL(4)=X:IPT$(4)=B$:IPT(4)=1:IPT(8)=1:IPL(8)=17-LEN(TA$):IPT$(8)=TA$:E$="":RETURN
1670 IF DAFDAF=2 THEN IPL(4)=26+LEN(B$):IPT$(4)=B$:IPT(4)=1:IPT(8)=1:X=17-LEN(TA$):IPL(8)=X:IPT$(8)=TA$:E$="":RETURN
1680 DATA "  - '","001"
1690 DATA "","009"
1700 DATA "  ","010"
1710 DATA " ","012"
1720 DATA "   ","017"
1730 DATA "","039"
1740 DATA " ","046"
1750 ' *****   *****
1760 LOCATE 20,2:PRINT SPACE$(77):GOSUB 2640:LOCATE 15,68:PRINT "*"
1770 TYPE=0:RESTORE 1990:LOCATE 20,3:COLOR 0,1:PRINT "   + ,  [Caps Lock]    ,  ":COLOR 3,0
1780 IF IPT(5)=0 THEN X=26:IPT$(5)="":IPT(5)=1 ELSE X=IPL(5)
1790 POKE 8,1:E$=INKEY$:IF E$="" THEN 1790 ELSE POKE 8,0
1800 IF E$=CHR$(27) THEN IPL(5)=X:GOTO 1460
1810 IF E$="+" THEN GOSUB 1910:GOTO 1790
1820 IF E$=CHR$(13) THEN 1900
1830 IF E$=CHR$(8) AND LEN(IPT$(5))=0 THEN BEEP:LOCATE 19,28:PRINT "    ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 1790
1840 IF E$=CHR$(8) THEN POKE 8,1:IPT$(5)=LEFT$(IPT$(5),(LEN(IPT$(5))-1)):LOCATE 15,X:PRINT "_":X=X-1:LOCATE 15,27:COLOR 15,0:PRINT IPT$(5):COLOR 3,0:POKE 8,0:GOTO 1790
1850 IF LEN(IPT$(5))=30 THEN BEEP:LOCATE 19,21:PRINT " 20 -     ":FOR I=1 TO 250:NEXT I:LOCATE 19,21:PRINT "                                     ":GOTO 1790
1860 X=X+1
1870 IPT$(5)=IPT$(5)+E$
1880 POKE 8,1:LOCATE 15,X:COLOR 11,0:PRINT E$:COLOR 3,0:POKE 8,0
1890 GOTO 1790
1900 IPL(5)=X:GOTO 2060
1910 ' *****    *****
1920 POKE 8,1:LOCATE 15,27:PRINT "____________________":POKE 8,0:LOCATE 15,14:PRINT "000":READ A$,KOD$:LOCATE 15,55-(LEN(A$)):COLOR 11,0:PRINT A$:LOCATE 15,17-LEN(KOD$):PRINT KOD$:COLOR 3,0:TYPE=TYPE+1
1930 IF TYPE=7 THEN TYPE=0:RESTORE 1990
1940 B$="":FOR I=1 TO LEN(A$)
1950 X$=MID$(A$,LEN(A$)+1-I,1)
1960 B$=B$+X$
1970 NEXT I:POKE 8,1
1980 X=26+LEN(B$):IPL(5)=X:IPT$(5)=B$:IPT(5)=1:IPT(6)=1:IPL(6)=17-LEN(KOD$):IPT$(6)=KOD$:E$="":RETURN
1990 DATA "'  ","001"
2000 DATA " ","002"
2010 DATA "","010"
2020 DATA "","011"
2030 DATA "","012"
2040 DATA " ","013"
2050 DATA "","020"
2060 ' *****   *****
2070 POKE 8,0:LOCATE 20,2:PRINT SPACE$(77)
2080 LOCATE 20,14:COLOR 0,1:PRINT "   + ,      ":COLOR 3,0:GOSUB 2640:LOCATE 15,29:PRINT "*"
2090 IF IPT(6)=0 THEN X=17:IPT$(6)="":IPT(6)=1 ELSE X=IPL(6)
2100 E$=INKEY$:IF E$="" THEN 2100
2110 IF E$="+" THEN GOSUB 1910:GOTO 2100
2120 IF E$=CHR$(27) THEN IPL(6)=X:GOTO 1750
2130 IF E$=CHR$(13) THEN IF VAL(IPT$(6))=0 THEN BEEP:IPL(6)=0:GOTO 1750 ELSE 2220
2140 IF E$=CHR$(8) AND LEN(IPT$(6))=0 THEN BEEP:LOCATE 19,28:PRINT "    ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 2100
2150 IF E$=CHR$(8) THEN IPT$(6)=LEFT$(IPT$(6),((LEN(IPT$(6)))-1)):LOCATE 15,X:PRINT "0":X=X+1:LOCATE 15,X:COLOR 11,0:PRINT IPT$(6):COLOR 3,0:GOTO 2100
2160 IF ASC(E$)<48 OR ASC(E$)>57 THEN BEEP:LOCATE 19,28:PRINT "   ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 2100
2170 IF LEN(IPT$(6))=3 THEN BEEP:LOCATE 19,22:PRINT " 3 -    ":FOR I=1 TO 250:NEXT I:LOCATE 19,22:PRINT "                                    ":GOTO 2100
2180 X=X-1
2190 IPT$(6)=IPT$(6)+E$
2200 COLOR 11,0:LOCATE 15,X:PRINT IPT$(6):COLOR 3,0
2210 GOTO 2100
2220 LOCATE 15,17-LEN(IPT$(6)):COLOR 11,0:PRINT IPT$(6):COLOR 3,0:IPL(6)=X:GOTO 2310
2230 ' *****    *****
2240 POKE 8,1:LOCATE 15,27:PRINT "____________________":POKE 8,0:LOCATE 15,14:PRINT "000":READ A$,KOD$:LOCATE 15,55-(LEN(A$)):COLOR 11,0:PRINT A$:LOCATE 15,17-LEN(KOD$):PRINT KOD$:COLOR 3,0:TYPE=TYPE+1
2250 IF TYPE=7 THEN TYPE=0:RESTORE 1990
2260 B$="":FOR I=1 TO LEN(A$)
2270 X$=MID$(A$,LEN(A$)+1-I,1)
2280 B$=B$+X$
2290 NEXT I
2300 X=17-LEN(KOD$):IPL(6)=X:IPT$(6)=KOD$:IPT(6)=1:IPT(5)=1:IPL(5)=26+LEN(B$):IPT$(5)=B$:E$="":RETURN
2310 ' *****   *****
2320 RESTORE 1990:POKE 8,0:LOCATE 20,2:PRINT SPACE$(77):GOSUB 2640:LOCATE 16,68:PRINT "*"
2330 LOCATE 20,25:COLOR 0,1:PRINT "      ":COLOR 3,0
2340 IF IPT(7)=0 THEN X=55:IPT$(7)="":IPT(7)=1 ELSE X=IPL(7)
2350 E$=INKEY$:IF E$="" THEN 2350
2360 IF E$=CHR$(27) THEN IPL(7)=X:GOTO 2060
2370 IF E$=CHR$(13) THEN IF VAL(IPT$(7))=0 THEN BEEP:LOCATE 19,22:PRINT "! ()      ":FOR I=1 TO 250:NEXT I:LOCATE 19,22:PRINT "                                   ":GOTO 2350
2380 IF E$=CHR$(13) AND VAL(IPT$(7))>0 THEN 2470
2390 IF E$=CHR$(8) AND LEN(IPT$(7))=0 THEN BEEP:LOCATE 19,28:PRINT "    ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 2350
2400 IF E$=CHR$(8) THEN IPT$(7)=LEFT$(IPT$(7),((LEN(IPT$(7)))-1)):LOCATE 16,X:PRINT "0":X=X+1:LOCATE 16,X:COLOR 11,0:PRINT IPT$(7):COLOR 3,0:GOTO 2350
2410 IF ASC(E$)<48 OR ASC(E$)>57 THEN BEEP:LOCATE 19,28:PRINT "   ":FOR I=1 TO 250:NEXT I:LOCATE 19,28:PRINT "                        ":GOTO 2350
2420 IF LEN(IPT$(7))=5 THEN BEEP:LOCATE 19,22:PRINT " 5 -    ":FOR I=1 TO 250:NEXT I:LOCATE 19,22:PRINT "                                   ":GOTO 2350
2430 X=X-1
2440 IPT$(7)=IPT$(7)+E$
2450 COLOR 11,0:LOCATE 16,X:PRINT IPT$(7):COLOR 3,0
2460 GOTO 2350
2470 LOCATE 16,55-LEN(IPT$(7)):COLOR 11,0:PRINT IPT$(7):COLOR 3,0:IPL(7)=X
2480 ' *****     *****
2490 RSET NLINES$="0"        ' 15
2500 RSET NACCOUNT$=IPT$(1)  ' 15
2510 LSET NAM$=IPT$(2)	     ' 40
2520 LSET CLIENTADD$=IPT$(3) ' 30
2530 LSET TYPEACC$=IPT$(4)   ' 20
2540 LSET TANUM$=IPT$(8)     ' 03
2550 LSET BANKNAM$=IPT$(5)   ' 20
2560 RSET BANKKOD$=IPT$(6)   ' 03
2570 RSET BANKNUM$=IPT$(7)   ' 05
2580 PUT #1,ENTRY+1
2590 A$=RIGHT$(STR$(CLIENT+1),(LEN(STR$(CLIENT))-1)):A$=A$+".BAN"
2600 OPEN "R",#2,A$,68
2610 FIELD #2,1 AS PAGESIGN$,5 AS PAGE$,10 AS BALANCE$,8 AS VALUEDATE$,10 AS MOVE$,2 AS SIGN$,4 AS AUTHORITY$,20 AS NOTES$,8 AS WRITENDATE$:RSET PAGE$="1":RSET BALANCE$="0":PUT #2,1:RSET PAGESIGN$="*":RSET VALUEDATE$="0":RSET PAGE$="1":PUT #2,2:CLOSE #2
2620 RSET NLINES$=STR$(CLIENT+1):PUT #1,1
2630 IF CLIENT+1<>ENTRY THEN 720 ELSE CLIENT=CLIENT+1:GOTO 720
2640 ' *****      *****
2650 FOR I=1 TO 4:LOCATE 7+I,68:PRINT " ":NEXT I:LOCATE 15,68:PRINT " ":LOCATE 16,68:PRINT " ":LOCATE 15,29:PRINT " ":LOCATE 11,29:PRINT " ":RETURN
2660 ' *****       *****
2670 IPT$(1)=A$:X=55-LEN(IPT$(1)):IPL(1)=X:IT=1
2680 POKE 8,1:LOCATE 9,27:COLOR 11,0:PRINT NAM$:IPT$(2)=NAM$:IPL(2)=26+LEN(NAM$):LOCATE 10,27:COLOR 11,0:PRINT CLIENTADD$:IPT$(3)=CLIENTADD$:IPL(3)=26+LEN(IPT$(3)):LOCATE 11,27:COLOR 11,0:PRINT TYPEACC$:POKE 8,0:IPT$(4)=TYPEACC$:IPL(4)=26+LEN(IPT$(4))
2690 LOCATE 11,17-LEN(TANUM$):COLOR 11,0:PRINT TANUM$:POKE 8,1:IPT$(8)=TANUM$:IPL(8)=17-LEN(TANUM$):LOCATE 15,27:COLOR 11,0:PRINT BANKNAM$:POKE 8,0:IPT$(5)=BANKNAM$:IPL(5)=26+LEN(IPT$(5))
2700 LOCATE 15,17-LEN(BANKKOD$):PRINT BANKKOD$:IPT$(6)=BANKKOD$:IPL(6)=17-LEN(IPT$(6)):LOCATE 16,55-LEN(BANKNUM$):PRINT BANKNUM$:COLOR 3,0:IPT$(7)=BANKNUM$:IPL(7)=55-LEN(BANKNUM$)
2710 FOR I=1 TO 8:IPT(I)=1:NEXT I:RETURN
2720 ' *****     *****
2730 KEY(3) OFF:KEY(4) OFF:LOCATE 8,68:PRINT " ":LOCATE 8,68:PRINT "*"
2740 IF TYP=0 THEN TYPE=TYPE+1 ELSE TYPE=TYPE-1
2750 IF TYPE>CLIENT+1 THEN TYPE=2
2760 IF TYPE<2 THEN TYPE=CLIENT+1
2770 GET #1,TYPE:A$=NACCOUNT$
2780 LOCATE 6,14:PRINT "000000":LOCATE 6,21-(LEN(STR$(TYPE))):COLOR 11,0:PRINT RIGHT$(STR$(TYPE-1),LEN(STR$(TYPE))-1):COLOR 3,0
2790 FOR P=1 TO 15
2800 IF MID$(A$,16-P,1)=" " THEN A$=RIGHT$(A$,P-1)
2810 NEXT P
2820 LOCATE 8,40:PRINT "000000000000000"
2830 E$="":X=55-LEN(A$):GOSUB 2660:POKE 8,1
2840 POKE 8,0:LOCATE 8,X:COLOR 11,0:PRINT A$:COLOR 3,0
2850 FOR P=15 TO 1 STEP -1
2860 IF MID$(A$,P,1)=" " THEN A$=RIGHT$(A$,15-P)
2870 NEXT P:X=55-LEN(A$):POKE 8,0:KEY(3) ON:KEY(4) ON:RETURN
2880 ' ***** 1     *****
2890 LOCATE 9,12:PRINT "            ______________________________ :       "
2900 LOCATE 10,12:PRINT "                  ________________________ :   "
2910 LOCATE 11,12:PRINT " 000 :        ____________________ :    "
2920 LOCATE 15,12:PRINT " 000 :          ____________________ :       "
2930 LOCATE 16,12:PRINT "                                     00000 :    "
2940 RETURN
2950 ' *****    *****
2960 LPRINT CHR$(27);CHR$(45);CHR$(1);
2970 LPRINT CHR$(14);SPACE$(6);":       -       :"
2980 LPRINT CHR$(20);:LPRINT CHR$(27);CHR$(45);CHR$(0);
2990 LPRINT
3000 LPRINT CHR$(27);CHR$(69);SPACE$(32);DD$;"-";MM$;"-";YY$;" : "
3010 LPRINT CHR$(27);CHR$(70);:LPRINT
3020 LPRINT CHR$(27);CHR$(70);:LPRINT:WIDTH "LPT1:",132
3030 LPRINT CHR$(15);SPACE$(16);"                                                             "
3040 LPRINT CHR$(15);SPACE$(16);"----- --- -------------------- --- -------------------- ------------------------------ --------------- ------"
3050 FOR I=1 TO CLIENT:GET #1,I+1:NA$="":TT$="":BAN$=""
3060 FOR J=30 TO 1 STEP -1:NA$=NA$+MID$(NAM$,J,1):NEXT J
3070 FOR J=20 TO 1 STEP -1:TT$=TT$+MID$(TYPEACC$,J,1):BAN$=BAN$+MID$(BANKNAM$,J,1):NEXT J
3080 LPRINT CHR$(15);SPACE$(16);SPACE$(5-LEN(BANKNUM$));BANKNUM$;" ";
3090 LPRINT CHR$(15);SPACE$(3-LEN(BANKKOD$));BANKKOD$;" ";
3100 LPRINT CHR$(15);SPACE$(20-LEN(BAN$));BAN$;" ";
3110 LPRINT CHR$(15);SPACE$(3-LEN(TANUM$));TANUM$;" ";
3120 LPRINT CHR$(15);SPACE$(20-LEN(TT$));TT$;" ";
3130 LPRINT CHR$(15);SPACE$(30-LEN(NA$));NA$;" ";
3140 LPRINT CHR$(15);SPACE$(15-LEN(NACCOUNT$));NACCOUNT$;" ";
3150 LPRINT CHR$(15);SPACE$(6-LEN(STR$(I)));I
3160 NEXT I
3170 LPRINT
3180 WIDTH "LPT1:",80:LPRINT CHR$(18);:GOTO 550
3190 ' *****     -   *****
3200 LOCATE 16,7:COLOR 1,0:PRINT "? - (2)   (1) ":COLOR 3,0
3210 LOCATE 16,5:COLOR 21,0:PRINT "_":COLOR 3,0
3220 LOCATE 22,2:PRINT SPACE$(77):LOCATE 22,20:PRINT "  [Esc]   2  1 "
3230 E$=INKEY$:IF E$="" THEN 3230 ELSE IF E$=CHR$(27) THEN 550
3240 IF E$="1" THEN LOCATE 16,5:PRINT E$:GOTO 2950
3250 IF E$="2" THEN LOCATE 16,5:PRINT E$:GOTO 3280
3260 IF E$=CHR$(27) THEN 550
3270 BEEP:GOTO 3230
3280 ' *****    *****
3290 POKE 8,0:LOCATE 3,3:PRINT DD$;"/";MM$;"/";YY$
3300 CLS:LOCATE 4,25:COLOR 1,0:PRINT ":       -       :":COLOR 3,0
3310 LOCATE 6,3:PRINT "                                         "
3320 LOCATE 7,3:PRINT "----- ---------------- ---------------- --------------- --------------- ---":P=2
3330 FOR I=1 TO 12:GET #1,P:P=P+1:IF P=CLIENT+3 THEN 3420
3340 LOCATE I+7,3:PRINT BANKNUM$;:POKE 8,1
3350 LOCATE I+7,57:PRINT LEFT$(BANKNAM$,16);
3360 LOCATE I+7,40:PRINT LEFT$(TYPEACC$,16);
3370 LOCATE I+7,24:PRINT LEFT$(NAM$,15);:POKE 8,0
3380 LOCATE I+7,59:PRINT NACCOUNT$;" ";SPACE$(3-LEN(STR$(P-2)));P-2
3390 NEXT I
3400 LOCATE 22,2:PRINT SPACE$(77):LOCATE 22,22:PRINT "  [Esc] ,   "
3410 E$=INKEY$:IF E$="" THEN 3410 ELSE IF E$=CHR$(27) THEN 550 ELSE 3330
3420 FOR J=I TO 12:LOCATE J+7,2:PRINT SPACE$(77);:NEXT J:LOCATE 22,2:PRINT SPACE$(77):LOCATE 22,32:PRINT "   "
3430 E$=INKEY$:IF E$="" THEN 3430 ELSE 550
3440 ' ***** ( )    *****
3450 CLS:FOR I=1 TO 17:FOR J=0 TO 8:BNK$(I,J)="":NEXT J,I:POKE 8,0:LOCATE 3,3:PRINT DD$;"/";MM$;"/";YY$:DAFKOD=0
3460 LOCATE 3,31:COLOR 1,0:PRINT ":    :":COLOR 3,0:LOCATE 3,59:PRINT "000000 :  "
3470 LOCATE 5,6:PRINT "____________________ :            000000000000000 :  "
3480 LOCATE 6,6:PRINT "           :    ______________________________ :     "
3490 LOCATE 7,3:PRINT "       :   ͻ"
3500 LOCATE 8,3:PRINT "                          . .."
3510 LOCATE 9,3:PRINT "͹"
3520 FOR I=10 TO 16:LOCATE I,3:PRINT "                                                                 ":NEXT I
3530 LOCATE 17,3:PRINT "͹"
3540 LOCATE 18,3:PRINT "                                                                 "
3550 LOCATE 19,3:PRINT "ͼ"
3560 ' *****    *****
3570 LOCATE 22,5:PRINT "  [Esc] ,  + - , [Ctrl] + [Q] , [<-]":ENTRY=0
3580 LOCATE 20,2:PRINT SPACE$(77):LOCATE 5,74:PRINT "*":GOSUB 3820:NUM$="":X=61
3590 E$=INKEY$:IF E$="" THEN 3590
3600 IF E$="+" OR E$="-" THEN 3860
3610 IF E$=CHR$(27) THEN 550
3620 IF E$=CHR$(13) THEN IF VAL(NUM$)=0 THEN BEEP:GOSUB 3840:LOCATE 20,22:PRINT "! ()      ":FOR I=1 TO 250:NEXT:GOSUB 3820:GOTO 3590 ELSE 3710
3630 IF E$=CHR$(8) AND LEN(NUM$)=0 THEN BEEP:GOSUB 3840:LOCATE 20,28:PRINT "    ":FOR I=1 TO 250:NEXT:GOSUB 3820:GOTO 3590
3640 IF E$=CHR$(8) THEN NUM$=LEFT$(NUM$,((LEN(NUM$))-1)):LOCATE 5,X:PRINT "0":X=X+1:LOCATE 5,X:COLOR 11,0:PRINT NUM$:COLOR 3,0:GOTO 3590
3650 IF ASC(E$)<48 OR ASC(E$)>57 THEN BEEP:GOSUB 3840:LOCATE 20,28:PRINT "   ":FOR I=1 TO 250:NEXT:GOSUB 3820:GOTO 3590
3660 IF LEN(NUM$)=15 THEN BEEP:GOSUB 3840:LOCATE 20,22:PRINT " 15 -    ":FOR I=1 TO 250:NEXT:GOSUB 3820:GOTO 3590
3670 X=X-1
3680 NUM$=NUM$+E$
3690 COLOR 11,0:LOCATE 5,X:PRINT NUM$:COLOR 3,0
3700 GOTO 3590
3710 ' *****      *****
3720 LOCATE 5,X:COLOR 11,0:PRINT NUM$:COLOR 3,0
3730 B$=NUM$:C$="":FOR D=LEN(B$) TO 14
3740 C$=C$+" "
3750 NEXT D:B$=C$+B$
3760 FOR J=2 TO CLIENT
3770 GET #1,J
3780 IF B$=NACCOUNT$ THEN ENTRY=J:GOTO 3800
3790 NEXT J:BEEP:GOSUB 3840:LOCATE 20,27:PRINT "    ":FOR I=1 TO 250:NEXT I:GOSUB 3830:GOTO 3590
3800 ' *****    *****
3810 GOSUB 4020:GOTO 4070
3820 ' *****    *****
3830 LOCATE 20,2:PRINT SPACE$(77):LOCATE 20,16:COLOR 0,1:PRINT "  ( )      ":COLOR 3,0:RETURN
3840 ' *****    *****
3850 LOCATE 20,2:PRINT SPACE$(77):RETURN
3860 ' *****    *****
3870 IF E$="+" THEN TYP=1 ELSE TYP=0
3880 ' *****     *****
3890 IF TYP=0 THEN ENTRY=ENTRY-1 ELSE ENTRY=ENTRY+1
3900 IF ENTRY>CLIENT+1 THEN ENTRY=2
3910 IF ENTRY<2 THEN ENTRY=CLIENT+1
3920 GET #1,ENTRY:A$=NACCOUNT$
3930 FOR P=1 TO 15
3940 IF MID$(A$,16-P,1)=" " THEN A$=RIGHT$(A$,P-1)
3950 NEXT P
3960 LOCATE 5,46:PRINT "000000000000000"
3970 E$="":X=61-LEN(A$):POKE 8,1
3980 POKE 8,0:LOCATE 5,X:COLOR 11,0:PRINT A$:COLOR 3,0
3990 FOR P=15 TO 1 STEP -1
4000 IF MID$(A$,P,1)=" " THEN A$=RIGHT$(A$,15-P)
4010 NEXT P:X=61-LEN(A$):NUM$=A$:POKE 8,0:GOSUB 4020:GOTO 3590
4020 ' *****       *****
4030 POKE 8,1:COLOR 11,0:LOCATE 5,56:PRINT BANKNAM$:LOCATE 6,21:PRINT NAM$:CLOSE #2:A$=STR$(ENTRY-1)+".DAT":A$=RIGHT$(A$,(LEN(A$)-1)):OPEN "R",#2,A$,68
4040 FIELD #2,1 AS PAGESIGN$,5 AS PAGE$,10 AS BALANCE$,1 AS BSIGN$,8 AS VALUEDATE$,10 AS MOVE$,1 AS MSIGN$,4 AS AUTHORITY$,12 AS NOTES$,8 AS WRITENDATE$
4050 GET #2,1:POKE 8,0:COLOR 3,0:LOCATE 3,59:PRINT "000000":COLOR 11,0:LOCATE 3,60+(6-LEN(STR$(ENTRY-1))):X$=STR$(ENTRY-1):X$=RIGHT$(X$,(LEN(X$)-1)):PRINT X$
4060 COLOR 3,0:LOCATE 6,6:PRINT "0000000000":LOCATE 7,32:PRINT "00000":COLOR 11,0:LOCATE 6,6:PRINT BALANCE$:LOCATE 7,32:PRINT PAGE$:HPAGE=VAL(PAGE$):WPAGE=HPAGE:COLOR 3,0:BAL=VAL(BALANCE$):SH=1:LN=VAL(VALUEDATE$):RETURN
4070 ' *****    *****
4080 I=1:LOCATE 5,76:PRINT " "
4090 I=I+1:GET #2,I:IF PAGESIGN$<>"*" THEN 4090
4100 IF WPAGE=VAL(PAGE$) THEN LST=VAL(VALUEDATE$) ELSE 4090
4110 LOCATE 18,75:PRINT "01":GOTO 4350
4120 ' *****  *****
4130 DAFKOD=1:CQ=1:GOSUB 4730:LOCATE 7,47:COLOR 0,1:PRINT "*":COLOR 3,0:LOCATE 20,2:PRINT SPACE$(77):LOCATE 20,25:PRINT "      ":LOCATE 7,32
4140 PRINT "00000":Y=7:X=37:LNG=5:DCR$="0":GESC=0:A$=STR$(DAF):GOSUB 4820
4150 DAF=VAL(A$):GOSUB 5040:IF E$=CHR$(27) THEN BEEP
4160 IF DAF=HPAGE THEN HPAGE=DAF:WPAGE=DAF:SH=1:DAFKOD=0:GOSUB 5430:GOTO 4070
4170 IF DAF<1 OR DAF>HPAGE-1 THEN BEEP:GOTO 4120
4180 FOR I=1 TO LN+2:GET #2,I:IF PAGESIGN$="*" AND DAF=VAL(PAGE$) THEN 4190 ELSE NEXT I
4190 J=0:SH=1:FOR K=I+1 TO LN+2:GET #2,K:J=J+1:IF PAGESIGN$="*" THEN 4300
4200 BNK$(J,5)=BALANCE$
4210 BNK$(J,6)=BSIGN$
4220 BNK$(J,2)=VALUEDATE$
4230 BNK$(J,3)=MOVE$
4240 BNK$(J,4)=MSIGN$
4250 BNK$(J,7)=AUTHORITY$
4260 BNK$(J,8)=NOTES$
4270 BNK$(J,1)=WRITENDATE$
4280 IF J<8 THEN SH=J:YY=9+SH:S=SH:S$=STR$(S):GOSUB 5400
4290 NEXT K
4300 ' *****  *****
4310 CQ=1:GOSUB 4730:LOCATE 18,77:COLOR 0,1:PRINT "*":COLOR 3,0:LOCATE 20,2:PRINT SPACE$(77):LOCATE 20,27:PRINT "     ":LOCATE 18,75
4320 PRINT "00":Y=18:X=77:LNG=2:DCR$="0":GESC=1:A$=STR$(SH):GOSUB 4820
4330 SH=VAL(A$):IF E$=CHR$(27) THEN 4120 ELSE GOSUB 5040
4340 IF SH<1 OR SH>LST THEN BEEP:GOTO 4300 ELSE YY=18:S$=A$:GOSUB 5400
4350 ' *****  . *****
4360 CQ=1:GOSUB 4730:LOCATE 18,73:COLOR 0,1:PRINT "*":COLOR 3,0:LOCATE 20,2:PRINT SPACE$(77):LOCATE 20,22:PRINT "       ":LOCATE 18,65:PRINT "00000000"
4370 Y=18:X=73:LNG=8:DCR$="0":GESC=1:A$=BNK$(SH,1):GOSUB 4820:BNK$(SH,1)=A$
4380 IF E$=CHR$(27) THEN 4300 ELSE GOSUB 5040
4390 FOR K=1 TO 13:K$=MID$(A$,K,1):IF K$="." THEN BEEP:GOTO 4350 ELSE NEXT K
4400 ' *****  . *****
4410 CQ=1:GOSUB 4730:LOCATE 18,64:COLOR 0,1:PRINT "*":COLOR 3,0:LOCATE 20,2:PRINT SPACE$(77):LOCATE 20,21:PRINT "       ":LOCATE 18,56:PRINT "00000000"
4420 Y=18:X=64:LNG=8:DCR$="0":GESC=1:A$=BNK$(SH,2):GOSUB 4820:BNK$(SH,2)=A$
4430 IF E$=CHR$(27) THEN 4350 ELSE GOSUB 5040
4440 FOR K=1 TO 13:K$=MID$(A$,K,1):IF K$="." THEN BEEP:GOTO 4400 ELSE NEXT K
4450 ' *****  *****
4460 CQ=1:GOSUB 4730:LOCATE 18,55:COLOR 0,1:PRINT "*":COLOR 3,0:LOCATE 20,2:PRINT SPACE$(77):LOCATE 20,24:PRINT "      ":LOCATE 18,42:PRINT "0000000000000"
4470 Y=18:X=55:LNG=13:DCR$="0":GESC=1:A$=BNK$(SH,3):GOSUB 4820:BNK$(SH,3)=A$
4480 IF E$=CHR$(27) THEN 4400 ELSE GOSUB 5040
4490 L=0:FOR K=1 TO 13:K$=MID$(A$,K,1):IF K$="." THEN L=L+1
4500 NEXT K:IF L>1 THEN BEEP:GOTO 4450
4510 ' *****   *****
4520 LOCATE 20,2:PRINT SPACE$(77)
4530 CQ=1:GOSUB 4730:LOCATE 18,41:COLOR 0,1:PRINT "*":COLOR 3,0:LOCATE 20,14:PRINT "          ":LOCATE 18,40:PRINT "_":Y=18:X=40:XS=X+1:LNG=1:DCR$="_":GESC=1:A$=BNK$(SH,4):GOSUB 4940:BNK$(SH,4)=A$
4540 IF E$=CHR$(27) THEN 4450 ELSE GOSUB 5040
4550 IF A$<>"+" AND A$<>"-" THEN BEEP:GOTO 4510
4560 ' *****  *****
4570 CQ=1:GOSUB 4730:LOCATE 18,39:COLOR 0,1:PRINT "*":COLOR 3,0:LOCATE 20,2:PRINT SPACE$(77):LOCATE 20,25:PRINT "      ":LOCATE 18,26:PRINT "0000000000000":Y=18:X=39:LNG=13:DCR$="0":GESC=1:A$=BNK$(SH,5):GOSUB 4820:BNK$(SH,5)=A$
4580 IF E$=CHR$(27) THEN 4510 ELSE GOSUB 5040
4590 L=0:FOR K=1 TO 13:K$=MID$(A$,K,1):IF K$="." THEN L=L+1
4600 NEXT K:IF L>1 THEN BEEP:GOTO 4560
4610 ' *****   *****
4620 LOCATE 20,2:PRINT SPACE$(77)
4630 CQ=1:GOSUB 4730:LOCATE 18,25:COLOR 0,1:PRINT "*":COLOR 3,0:LOCATE 20,14:PRINT "          ":LOCATE 18,24:PRINT "_":Y=18:X=56:XS=X+1:LNG=1:DCR$="_":GESC=1:A$=BNK$(SH,6):GOSUB 4940:BNK$(SH,6)=A$
4640 IF E$=CHR$(27) THEN 4560 ELSE GOSUB 5040
4650 IF A$<>"+" AND A$<>"-" THEN BEEP:GOTO 4610
4660 ' *****  *****
4670 CQ=1:GOSUB 4730:LOCATE 18,23:COLOR 0,1:PRINT "*":COLOR 3,0:LOCATE 20,2:PRINT SPACE$(77):LOCATE 20,23:PRINT "      ":LOCATE 18,17:PRINT "000000":Y=18:X=23:LNG=6:DCR$="0":GESC=1:A$=BNK$(SH,7):GOSUB 4820:BNK$(SH,7)=A$
4680 IF E$=CHR$(27) THEN 4610 ELSE GOSUB 5040
4690 FOR K=1 TO 6:K$=MID$(A$,K,1):IF K$="." THEN BEEP:GOTO 4660 ELSE NEXT K
4700 ' *****  *****
4710 CQ=1:GOSUB 4730:LOCATE 18,16:COLOR 0,1:PRINT "*":COLOR 3,0:LOCATE 20,2:PRINT SPACE$(77):LOCATE 20,24:PRINT "      ":LOCATE 18,4:PRINT "____________":Y=18:X=65:XS=X+1:LNG=12:DCR$="_":GESC=1:A$=BNK$(SH,8):GOSUB 4940
4720 BNK$(SH,8)=A$:GOSUB 5040:IF E$=CHR$(27) THEN 4660 ELSE 4770
4730 ' *****   *****
4740 LOCATE 18,77:PRINT "":LOCATE 7,47:PRINT " ":RESTORE 4760
4750 FOR I=1 TO 8:READ X:LOCATE 18,X:PRINT "":NEXT I:RETURN
4760 DATA 73,64,55,41,39,25,23,16
4770 ' *****    *****
4780 IF SH>LST THEN LST=LST+1
4790 S=SH:M=S:IF S>7 THEN M=S-7 ELSE IF S>14 THEN M=S-14
4800 S=M:YY=9+SH:S$=STR$(S):GOSUB 5400:SH=LST+1:IF SH<18 THEN LOCATE 18,3:PRINT "                                                                 ":LOCATE 18,75:PRINT USING "##";SH ELSE E$=CHR$(17):GOTO 5050
4810 GOTO 4350
4820 ' *****    *****
4830 X=X-LEN(A$):LOCATE Y,X:COLOR 11,0:PRINT A$:COLOR 3,0
4840 E$=INKEY$:IF E$="" THEN 4840 ELSE IF CQ=1 THEN IF E$=CHR$(17) OR E$=CHR$(5) THEN RETURN
4850 IF E$=CHR$(27) THEN IF GESC=0 THEN BEEP:GOTO 4840 ELSE RETURN
4860 IF E$=CHR$(13) THEN IF LEN(A$)=0 THEN BEEP:GOTO 4840 ELSE RETURN
4870 IF E$=CHR$(8) THEN IF LEN(A$)=0 THEN BEEP:GOTO 4840 ELSE 4920
4880 IF E$="." THEN 4900
4890 IF ASC(E$)<48 OR ASC(E$)>57 THEN BEEP:GOTO 4840
4900 IF LEN(A$)=LNG THEN BEEP:GOTO 4840
4910 X=X-1:A$=A$+E$:COLOR 11,0:LOCATE Y,X:PRINT A$:COLOR 3,0:GOTO 4840
4920 ' *****  *****
4930 A$=LEFT$(A$,LEN(A$)-1):LOCATE Y,X:PRINT DCR$:X=X+1:LOCATE Y,X:COLOR 11,0:PRINT A$:COLOR 3,0:GOTO 4840
4940 ' *****    *****
4950 POKE 8,1:X=X+LEN(A$):LOCATE Y,XS:COLOR 11,0:PRINT A$:COLOR 3,0
4960 POKE 8,1:E$=INKEY$:IF E$="" THEN 4960 ELSE POKE 8,0
4970 IF E$=CHR$(27) THEN IF GESC=0 THEN BEEP:GOTO 4960 ELSE RETURN
4980 IF E$=CHR$(13) THEN IF LEN(A$)=0 THEN BEEP:GOTO 4960 ELSE RETURN
4990 IF E$=CHR$(8) THEN IF LEN(A$)=0 THEN BEEP:GOTO 4960 ELSE 5020
5000 IF LEN(A$)=LNG THEN BEEP:GOTO 4960
5010 X=X+1:A$=A$+E$:COLOR 11,0:POKE 8,1:LOCATE Y,X:PRINT E$:COLOR 3,0:POKE 8,0:GOTO 4960
5020 ' *****  *****
5030 POKE 8,1:A$=LEFT$(A$,LEN(A$)-1):LOCATE Y,X:PRINT DCR$:X=X-1:LOCATE Y,XS:COLOR 11,0:PRINT A$:POKE 8,0:COLOR 3,0:GOTO 4960
5040 ' *****  *****
5050 IF E$=CHR$(17) THEN 5090
5060 IF E$=CHR$(5) THEN CLOSE #2:GOTO 550
5070 IF DAFKOD=1 THEN BEEP:RETURN
5080 RETURN
5090 LOCATE 20,2:PRINT SPACE$(77):LOCATE 20,7:PRINT "__ : (!!!      ) - - ?   ":COLOR 3,0
5100 E$=INKEY$:IF E$="" THEN 5100
5110 IF E$="F" OR E$="f" OR E$="" THEN LOCATE 20,7:PRINT "":GOTO 5140
5120 IF E$="K" OR E$="k" OR E$="" THEN LOCATE 20,7:PRINT "":RETURN
5130 GOTO 5100
5140 LOCATE 20,2:PRINT SPACE$(77):COLOR 28,0:LOCATE 20,30:PRINT "  , ":COLOR 3,0:FOR I=1 TO LST:IF BNK$(I,4)="+" THEN BAL=BAL+VAL(BNK$(I,3)) ELSE BAL=BAL-VAL(BNK$(I,3))
5150 NEXT I
5160 FOR I=1 TO LST
5170 RSET PAGESIGN$=" "
5180 RSET PAGE$=HPAGE$
5190 RSET BALANCE$=BNK$(I,5)
5200 RSET BSIGN$=BNK$(I,6)
5210 RSET VALUEDATE$=BNK$(I,2)
5220 RSET MOVE$=BNK$(I,3)
5230 RSET MSIGN$=BNK$(I,4)
5240 RSET AUTHORITY$=BNK$(I,7)
5250 RSET NOTES$=BNK$(I,8)
5260 RSET WRITENDATE$=BNK$(I,1)
5270 PUT #2,LN+I+2
5280 IF VAL(BNK$(I,3))<>0 THEN SHUR=I
5290 NEXT I:LN=LN+I+3
5300 RSET PAGESIGN$="*"
5310 RSET PAGE$=STR$(HPAGE+1)
5320 RSET BALANCE$=STR$(BAL)
5330 RSET VALUEDATE$=STR$(LN)
5340 PUT #2,1
5350 RSET PAGESIGN$="*"
5360 RSET PAGE$=STR$(HPAGE+1)
5370 RSET VALUEDATE$=STR$(LST)
5380 PUT #2,LN-1
5390 CLOSE #2:LOCATE 22,2:PRINT SPACE$(77):GOTO 3450
5400 ' *****         *****
5410 COLOR 11,0:S=VAL(S$):LOCATE YY,75:PRINT USING "##";S:LOCATE YY,65:PRINT USING "\      \";BNK$(S,1):LOCATE YY,56:PRINT USING "\      \";BNK$(S,2):LOCATE YY,42:PRINT USING "##########.##";VAL(BNK$(S,3)):LOCATE YY,40:PRINT BNK$(S,4)
5420 LOCATE YY,26:PRINT USING "##########.##";VAL(BNK$(S,5)):LOCATE YY,24:PRINT BNK$(S,6):LOCATE YY,17:PRINT USING "######";VAL(BNK$(S,7)):POKE 8,1:LOCATE YY,66:PRINT BNK$(S,8):POKE 8,0:COLOR 3,0:RETURN
5430 ' *****     *****
5440 FOR I=1 TO 17:FOR J=0 TO 8:BNK$(I,J)="":NEXT J,I
5450 FOR I=1 TO 7:LOCATE I+9,3:PRINT "                                                                 ":NEXT I:J=1:RETURN